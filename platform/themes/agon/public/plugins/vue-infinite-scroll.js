!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.infiniteScroll=t()}(this,function(){"use strict";var o="@@InfiniteScroll",s=function(e){return e===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):e.scrollTop},p=document.defaultView.getComputedStyle,a=function(e){return e===window?s(window):e.getBoundingClientRect().top+s(window)},r=function(e){for(var t=e.parentNode;t;){if("HTML"===t.tagName)return!0;if(11===t.nodeType)return!1;t=t.parentNode}return!1},l=function(){if(!this.binded){this.binded=!0;var e,t,n,i,o,r,l,c,s=this,a=s.el,u=a.getAttribute("infinite-scroll-throttle-delay"),d=200;u&&(d=Number(s.vm[u]||u),(isNaN(d)||d<0)&&(d=200)),s.throttleDelay=d,s.scrollEventTarget=function(e){for(var t=e;t&&"HTML"!==t.tagName&&"BODY"!==t.tagName&&1===t.nodeType;){var n=p(t).overflowY;if("scroll"===n||"auto"===n)return t;t=t.parentNode}return window}(a),s.scrollListener=(e=T.bind(s),t=s.throttleDelay,c=function(){e.apply(r,l),i=n},function(){if(r=this,l=arguments,n=Date.now(),o&&(clearTimeout(o),o=null),i){var e=t-(n-i);e<0?c():o=setTimeout(function(){c()},e)}else c()}),s.scrollEventTarget.addEventListener("scroll",s.scrollListener),this.vm.$on("hook:beforeDestroy",function(){s.scrollEventTarget.removeEventListener("scroll",s.scrollListener)});var f=a.getAttribute("infinite-scroll-disabled"),m=!1;f&&(this.vm.$watch(f,function(e){!(s.disabled=e)&&s.immediateCheck&&T.call(s)}),m=Boolean(s.vm[f])),s.disabled=m;var v=a.getAttribute("infinite-scroll-distance"),h=0;v&&(h=Number(s.vm[v]||v),isNaN(h)&&(h=0)),s.distance=h;var g=a.getAttribute("infinite-scroll-immediate-check"),w=!0;g&&(w=Boolean(s.vm[g])),(s.immediateCheck=w)&&T.call(s);var b=a.getAttribute("infinite-scroll-listen-for-event");b&&s.vm.$on(b,function(){T.call(s)})}},T=function(e){var t=this.scrollEventTarget,n=this.el,i=this.distance;if(!0===e||!this.disabled){var o,r=s(t),l=r+((o=t)===window?document.documentElement.clientHeight:o.clientHeight),c=!1;if(t===n)c=t.scrollHeight-l<=i;else c=a(n)-a(t)+n.offsetHeight+r<=l+i;c&&this.expression&&this.expression()}},t={bind:function(t,e,n){t[o]={el:t,vm:n.context,expression:e.value};var i=arguments;t[o].vm.$on("hook:mounted",function(){t[o].vm.$nextTick(function(){r(t)&&l.call(t[o],i),t[o].bindTryCount=0;!function e(){10<t[o].bindTryCount||(t[o].bindTryCount++,r(t)?l.call(t[o],i):setTimeout(e,50))}()})})},unbind:function(e){e&&e[o]&&e[o].scrollEventTarget&&e[o].scrollEventTarget.removeEventListener("scroll",e[o].scrollListener)}},e=function(e){e.directive("InfiniteScroll",t)};return window.Vue&&(window.infiniteScroll=t,Vue.use(e)),t.install=e,t});
